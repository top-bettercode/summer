<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="top.bettercode.simpleframework.data.test.repository.UserRepository">

  <resultMap id="userResultMap" type="top.bettercode.simpleframework.data.test.resp.CUser">
    <result property="firstName" column="first_name"/>
    <collection property="lastName" javaType="java.util.List"
      ofType="java.lang.String">
      <result column="last_name"/>
    </collection>
  </resultMap>

  <resultMap id="userResultMap2" type="top.bettercode.simpleframework.data.test.resp.CUsers">
    <result property="firstName" column="first_name"/>
    <collection property="lastName" javaType="java.util.List"
      ofType="top.bettercode.simpleframework.data.test.resp.LastName">
      <result property="lastName" column="last_name"/>
      <result property="deleted" column="deleted"/>
    </collection>
  </resultMap>

  <resultMap id="userResultMap3" type="top.bettercode.simpleframework.data.test.resp.AUser">
    <result property="id" column="id"/>
    <result property="firstName" column="first_name"/>
    <association property="lastName"
      javaType="top.bettercode.simpleframework.data.test.resp.LastName">
      <result property="lastName" column="last_name"/>
      <result property="deleted" column="deleted"/>
    </association>
  </resultMap>

  <select id="selectResultMap" resultMap="userResultMap"
    parameterType="top.bettercode.simpleframework.data.test.domain.User">
    select *
    from user
    where first_name = #{firstName}
    <if test="lastName!=null">
      and last_name = #{lastName}
    </if>
  </select>

  <select id="selectResultMap2" resultMap="userResultMap2"
    parameterType="top.bettercode.simpleframework.data.test.domain.User">
    select *
    from user
    where first_name = #{firstName}
    <if test="lastName!=null">
      and last_name = #{lastName}
    </if>
  </select>

  <select id="selectResultMap3" resultMap="userResultMap3"
    parameterType="top.bettercode.simpleframework.data.test.domain.User">
    select *
    from user
    where first_name = #{firstName}
    <if test="lastName!=null">
      and last_name = #{lastName}
    </if>
  </select>

  <insert id="insert">
    insert into user (first_name, last_name, id)
    values (#{firstName}, #{lastName}, 100)
  </insert>
  <update id="update">
    update user
    set last_name=#{lastName}
    where id = #{id}
  </update>
  <update id="updateNoReturn">
    update user
    set last_name=#{lastName}
    where id = #{id}
  </update>
  <delete id="deleteMybatis">
    delete
    from user
    where id = #{id}
  </delete>
  <delete id="deleteMybatisNoResturn">
    delete
    from user
    where id = #{id}
  </delete>

  <select id="selectMybatisAll_COUNT" resultType="java.lang.Long">
    select count(1)
    from user
    where deleted = 0
  </select>
  <select id="selectMybatisAll" resultType="top.bettercode.simpleframework.data.test.domain.User">
    select first_name, last_name
    from user
    where deleted = 0
  </select>
  <select id="selectMybatisIfParam"
    resultType="top.bettercode.simpleframework.data.test.domain.User">
    select *
    from user
    where first_name = #{firstName} AND first_name = #{firstName}
    <if test="lastName!=null or param2!=null">
      and last_name = #{param2}
    </if>
  </select>
  <select id="selectMybatisStream"
    resultType="top.bettercode.simpleframework.data.test.domain.User">
    select *
    from user
    where first_name = #{firstName} AND first_name = #{firstName}
    <if test="lastName!=null or param2!=null">
      and last_name = #{param2}
    </if>
  </select>
  <select id="selectByMybatisMap" resultType="top.bettercode.simpleframework.data.test.domain.User">
    select *
    from user
    where first_name = #{firstName}
    <if test="lastName!=null">
      and last_name = #{lastName}
    </if>
  </select>
  <select id="selectByMybatisSort"
    resultType="top.bettercode.simpleframework.data.test.domain.User">
    select *
    from user
    where first_name = #{firstName}
  </select>
  <select id="selectOneByMybatis"
    resultType="top.bettercode.simpleframework.data.test.domain.User">
    select *
    from user
    where deleted = 0
      and first_name = #{a}
  </select>
  <select id="selectByMybatisEntity"
    resultType="top.bettercode.simpleframework.data.test.domain.User">
    select *
    from user
    where first_name = #{firstName}
    <if test="lastName!=null">
      and last_name = #{lastName}
    </if>
  </select>
  <select id="selectMybatisMapList" resultType="java.util.Map">
    select first_name, last_name
    from user
    where deleted = 0
  </select>
  <select id="selectMybatisMap" resultType="java.util.Map">
    select first_name, last_name
    from user
    where deleted = 0
    order by id limit 1
  </select>
</mapper>
